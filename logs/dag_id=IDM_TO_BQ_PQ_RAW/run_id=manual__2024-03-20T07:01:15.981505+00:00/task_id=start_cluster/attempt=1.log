[2024-03-20T07:01:17.500+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: IDM_TO_BQ_PQ_RAW.start_cluster manual__2024-03-20T07:01:15.981505+00:00 [queued]>
[2024-03-20T07:01:17.503+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: IDM_TO_BQ_PQ_RAW.start_cluster manual__2024-03-20T07:01:15.981505+00:00 [queued]>
[2024-03-20T07:01:17.504+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-03-20T07:01:17.509+0000] {taskinstance.py:2217} INFO - Executing <Task(BashOperator): start_cluster> on 2024-03-20 07:01:15.981505+00:00
[2024-03-20T07:01:17.511+0000] {standard_task_runner.py:60} INFO - Started process 2638 to run task
[2024-03-20T07:01:17.513+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'IDM_TO_BQ_PQ_RAW', 'start_cluster', 'manual__2024-03-20T07:01:15.981505+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/IDM_TO_BQ_PQ_RAW.py', '--cfg-path', '/tmp/tmpe6ss5kgk']
[2024-03-20T07:01:17.514+0000] {standard_task_runner.py:88} INFO - Job 7: Subtask start_cluster
[2024-03-20T07:01:17.522+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.8/site-packages/***/settings.py:194 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2024-03-20T07:01:17.537+0000] {task_command.py:423} INFO - Running <TaskInstance: IDM_TO_BQ_PQ_RAW.start_cluster manual__2024-03-20T07:01:15.981505+00:00 [running]> on host bc8b6df1052f
[2024-03-20T07:01:17.565+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='admin' AIRFLOW_CTX_DAG_ID='IDM_TO_BQ_PQ_RAW' AIRFLOW_CTX_TASK_ID='start_cluster' AIRFLOW_CTX_EXECUTION_DATE='2024-03-20T07:01:15.981505+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-03-20T07:01:15.981505+00:00'
[2024-03-20T07:01:17.566+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2024-03-20T07:01:17.566+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "#!/bin/bash\n\nSERVICE_ACCOUNT_FILE_NAME=$GOOGLE_APPLICATION_CREDENTIALS\nDATAPROC_CLUSTER=dez-cluster\nDATAPROC_REGION=us-central1\nGCP_PROJECT=dez-workspace-emil\n\necho\necho 'SETTING UP SERVICE ACCOUNT'\ngcloud auth activate-service-account --key-file=$SERVICE_ACCOUNT_FILE_NAME\ngcloud config set project $GCP_PROJECT\n\necho\necho 'START CLUSTER'\ngcloud dataproc clusters start $DATAPROC_CLUSTER --region=$DATAPROC_REGION"]
[2024-03-20T07:01:17.570+0000] {subprocess.py:86} INFO - Output:
[2024-03-20T07:01:17.571+0000] {subprocess.py:93} INFO - 
[2024-03-20T07:01:17.571+0000] {subprocess.py:93} INFO - SETTING UP SERVICE ACCOUNT
[2024-03-20T07:01:18.276+0000] {subprocess.py:93} INFO - Activated service account credentials for: [dez-project-emil@dez-workspace-emil.iam.gserviceaccount.com]
[2024-03-20T07:01:18.975+0000] {subprocess.py:93} INFO - WARNING: You do not appear to have access to project [dez-workspace-emil] or it does not exist.
[2024-03-20T07:01:18.978+0000] {subprocess.py:93} INFO - Updated property [core/project].
[2024-03-20T07:01:19.060+0000] {subprocess.py:93} INFO - 
[2024-03-20T07:01:19.060+0000] {subprocess.py:93} INFO - START CLUSTER
[2024-03-20T07:01:19.927+0000] {subprocess.py:93} INFO - Waiting on operation [projects/dez-workspace-emil/regions/us-central1/operations/9d9874a8-79a7-3531-8c35-9cedbe24a5f8].
[2024-03-20T07:04:37.575+0000] {subprocess.py:93} INFO - done: true
[2024-03-20T07:04:37.577+0000] {subprocess.py:93} INFO - metadata:
[2024-03-20T07:04:37.577+0000] {subprocess.py:93} INFO -   '@type': type.googleapis.com/google.cloud.dataproc.v1.ClusterOperationMetadata
[2024-03-20T07:04:37.577+0000] {subprocess.py:93} INFO -   clusterName: dez-cluster
[2024-03-20T07:04:37.577+0000] {subprocess.py:93} INFO -   clusterUuid: 830261e5-2d3d-4491-a80c-fd201b1ad541
[2024-03-20T07:04:37.577+0000] {subprocess.py:93} INFO -   description: Start cluster
[2024-03-20T07:04:37.578+0000] {subprocess.py:93} INFO -   operationType: START
[2024-03-20T07:04:37.578+0000] {subprocess.py:93} INFO -   status:
[2024-03-20T07:04:37.578+0000] {subprocess.py:93} INFO -     innerState: DONE
[2024-03-20T07:04:37.578+0000] {subprocess.py:93} INFO -     state: DONE
[2024-03-20T07:04:37.578+0000] {subprocess.py:93} INFO -     stateStartTime: '2024-03-20T07:04:37.470832Z'
[2024-03-20T07:04:37.579+0000] {subprocess.py:93} INFO -   statusHistory:
[2024-03-20T07:04:37.579+0000] {subprocess.py:93} INFO -   - state: PENDING
[2024-03-20T07:04:37.579+0000] {subprocess.py:93} INFO -     stateStartTime: '2024-03-20T07:01:19.903763Z'
[2024-03-20T07:04:37.579+0000] {subprocess.py:93} INFO -   - state: RUNNING
[2024-03-20T07:04:37.579+0000] {subprocess.py:93} INFO -     stateStartTime: '2024-03-20T07:01:19.962912Z'
[2024-03-20T07:04:37.579+0000] {subprocess.py:93} INFO - name: projects/dez-workspace-emil/regions/us-central1/operations/9d9874a8-79a7-3531-8c35-9cedbe24a5f8
[2024-03-20T07:04:37.579+0000] {subprocess.py:93} INFO - response:
[2024-03-20T07:04:37.580+0000] {subprocess.py:93} INFO -   '@type': type.googleapis.com/google.cloud.dataproc.v1.Cluster
[2024-03-20T07:04:37.580+0000] {subprocess.py:93} INFO -   clusterName: dez-cluster
[2024-03-20T07:04:37.580+0000] {subprocess.py:93} INFO -   clusterUuid: 830261e5-2d3d-4491-a80c-fd201b1ad541
[2024-03-20T07:04:37.580+0000] {subprocess.py:93} INFO -   config:
[2024-03-20T07:04:37.580+0000] {subprocess.py:93} INFO -     configBucket: dataproc-staging-us-central1-329749248489-jq1oe9c7
[2024-03-20T07:04:37.580+0000] {subprocess.py:93} INFO -     encryptionConfig: {}
[2024-03-20T07:04:37.581+0000] {subprocess.py:93} INFO -     endpointConfig: {}
[2024-03-20T07:04:37.581+0000] {subprocess.py:93} INFO -     gceClusterConfig:
[2024-03-20T07:04:37.581+0000] {subprocess.py:93} INFO -       internalIpOnly: false
[2024-03-20T07:04:37.581+0000] {subprocess.py:93} INFO -       networkUri: https://www.googleapis.com/compute/v1/projects/dez-workspace-emil/global/networks/default
[2024-03-20T07:04:37.581+0000] {subprocess.py:93} INFO -       serviceAccountScopes:
[2024-03-20T07:04:37.581+0000] {subprocess.py:93} INFO -       - https://www.googleapis.com/auth/cloud-platform
[2024-03-20T07:04:37.581+0000] {subprocess.py:93} INFO -       shieldedInstanceConfig:
[2024-03-20T07:04:37.582+0000] {subprocess.py:93} INFO -         enableIntegrityMonitoring: false
[2024-03-20T07:04:37.582+0000] {subprocess.py:93} INFO -         enableSecureBoot: false
[2024-03-20T07:04:37.582+0000] {subprocess.py:93} INFO -         enableVtpm: false
[2024-03-20T07:04:37.582+0000] {subprocess.py:93} INFO -       zoneUri: https://www.googleapis.com/compute/v1/projects/dez-workspace-emil/zones/us-central1-b
[2024-03-20T07:04:37.582+0000] {subprocess.py:93} INFO -     masterConfig:
[2024-03-20T07:04:37.582+0000] {subprocess.py:93} INFO -       diskConfig:
[2024-03-20T07:04:37.583+0000] {subprocess.py:93} INFO -         bootDiskSizeGb: 100
[2024-03-20T07:04:37.583+0000] {subprocess.py:93} INFO -         bootDiskType: pd-standard
[2024-03-20T07:04:37.583+0000] {subprocess.py:93} INFO -       imageUri: https://www.googleapis.com/compute/v1/projects/cloud-dataproc/global/images/dataproc-2-1-ubu20-20240306-155100-rc01
[2024-03-20T07:04:37.583+0000] {subprocess.py:93} INFO -       machineTypeUri: https://www.googleapis.com/compute/v1/projects/dez-workspace-emil/zones/us-central1-b/machineTypes/e2-standard-2
[2024-03-20T07:04:37.583+0000] {subprocess.py:93} INFO -       minCpuPlatform: AUTOMATIC
[2024-03-20T07:04:37.583+0000] {subprocess.py:93} INFO -       numInstances: 1
[2024-03-20T07:04:37.584+0000] {subprocess.py:93} INFO -       preemptibility: NON_PREEMPTIBLE
[2024-03-20T07:04:37.584+0000] {subprocess.py:93} INFO -     securityConfig:
[2024-03-20T07:04:37.584+0000] {subprocess.py:93} INFO -       kerberosConfig: {}
[2024-03-20T07:04:37.584+0000] {subprocess.py:93} INFO -     softwareConfig:
[2024-03-20T07:04:37.584+0000] {subprocess.py:93} INFO -       imageVersion: 2.1.43-ubuntu20
[2024-03-20T07:04:37.585+0000] {subprocess.py:93} INFO -       properties:
[2024-03-20T07:04:37.585+0000] {subprocess.py:93} INFO -         capacity-scheduler:yarn.scheduler.capacity.root.default.ordering-policy: fair
[2024-03-20T07:04:37.585+0000] {subprocess.py:93} INFO -         core:fs.gs.block.size: '134217728'
[2024-03-20T07:04:37.585+0000] {subprocess.py:93} INFO -         core:fs.gs.metadata.cache.enable: 'false'
[2024-03-20T07:04:37.585+0000] {subprocess.py:93} INFO -         core:hadoop.ssl.enabled.protocols: TLSv1,TLSv1.1,TLSv1.2
[2024-03-20T07:04:37.585+0000] {subprocess.py:93} INFO -         distcp:mapreduce.map.java.opts: -Xmx768m
[2024-03-20T07:04:37.586+0000] {subprocess.py:93} INFO -         distcp:mapreduce.map.memory.mb: '1024'
[2024-03-20T07:04:37.586+0000] {subprocess.py:93} INFO -         distcp:mapreduce.reduce.java.opts: -Xmx768m
[2024-03-20T07:04:37.586+0000] {subprocess.py:93} INFO -         distcp:mapreduce.reduce.memory.mb: '1024'
[2024-03-20T07:04:37.586+0000] {subprocess.py:93} INFO -         hadoop-env:HADOOP_DATANODE_OPTS: -Xmx512m
[2024-03-20T07:04:37.586+0000] {subprocess.py:93} INFO -         hdfs:dfs.datanode.address: 0.0.0.0:9866
[2024-03-20T07:04:37.586+0000] {subprocess.py:93} INFO -         hdfs:dfs.datanode.http.address: 0.0.0.0:9864
[2024-03-20T07:04:37.587+0000] {subprocess.py:93} INFO -         hdfs:dfs.datanode.https.address: 0.0.0.0:9865
[2024-03-20T07:04:37.587+0000] {subprocess.py:93} INFO -         hdfs:dfs.datanode.ipc.address: 0.0.0.0:9867
[2024-03-20T07:04:37.587+0000] {subprocess.py:93} INFO -         hdfs:dfs.namenode.handler.count: '20'
[2024-03-20T07:04:37.587+0000] {subprocess.py:93} INFO -         hdfs:dfs.namenode.http-address: 0.0.0.0:9870
[2024-03-20T07:04:37.587+0000] {subprocess.py:93} INFO -         hdfs:dfs.namenode.https-address: 0.0.0.0:9871
[2024-03-20T07:04:37.587+0000] {subprocess.py:93} INFO -         hdfs:dfs.namenode.lifeline.rpc-address: dez-cluster-m:8050
[2024-03-20T07:04:37.588+0000] {subprocess.py:93} INFO -         hdfs:dfs.namenode.secondary.http-address: 0.0.0.0:9868
[2024-03-20T07:04:37.588+0000] {subprocess.py:93} INFO -         hdfs:dfs.namenode.secondary.https-address: 0.0.0.0:9869
[2024-03-20T07:04:37.588+0000] {subprocess.py:93} INFO -         hdfs:dfs.namenode.service.handler.count: '10'
[2024-03-20T07:04:37.588+0000] {subprocess.py:93} INFO -         hdfs:dfs.namenode.servicerpc-address: dez-cluster-m:8051
[2024-03-20T07:04:37.588+0000] {subprocess.py:93} INFO -         mapred-env:HADOOP_JOB_HISTORYSERVER_HEAPSIZE: '2048'
[2024-03-20T07:04:37.588+0000] {subprocess.py:93} INFO -         mapred:mapreduce.job.maps: '21'
[2024-03-20T07:04:37.589+0000] {subprocess.py:93} INFO -         mapred:mapreduce.job.reduce.slowstart.completedmaps: '0.95'
[2024-03-20T07:04:37.589+0000] {subprocess.py:93} INFO -         mapred:mapreduce.job.reduces: '7'
[2024-03-20T07:04:37.589+0000] {subprocess.py:93} INFO -         mapred:mapreduce.jobhistory.recovery.store.class: org.apache.hadoop.mapreduce.v2.hs.HistoryServerLeveldbStateStoreService
[2024-03-20T07:04:37.589+0000] {subprocess.py:93} INFO -         mapred:mapreduce.map.cpu.vcores: '1'
[2024-03-20T07:04:37.589+0000] {subprocess.py:93} INFO -         mapred:mapreduce.map.java.opts: -Xmx2708m
[2024-03-20T07:04:37.589+0000] {subprocess.py:93} INFO -         mapred:mapreduce.map.memory.mb: '3386'
[2024-03-20T07:04:37.590+0000] {subprocess.py:93} INFO -         mapred:mapreduce.reduce.cpu.vcores: '1'
[2024-03-20T07:04:37.590+0000] {subprocess.py:93} INFO -         mapred:mapreduce.reduce.java.opts: -Xmx2708m
[2024-03-20T07:04:37.590+0000] {subprocess.py:93} INFO -         mapred:mapreduce.reduce.memory.mb: '3386'
[2024-03-20T07:04:37.590+0000] {subprocess.py:93} INFO -         mapred:mapreduce.task.io.sort.mb: '256'
[2024-03-20T07:04:37.590+0000] {subprocess.py:93} INFO -         mapred:yarn.app.mapreduce.am.command-opts: -Xmx2708m
[2024-03-20T07:04:37.590+0000] {subprocess.py:93} INFO -         mapred:yarn.app.mapreduce.am.resource.cpu-vcores: '1'
[2024-03-20T07:04:37.590+0000] {subprocess.py:93} INFO -         mapred:yarn.app.mapreduce.am.resource.mb: '3386'
[2024-03-20T07:04:37.591+0000] {subprocess.py:93} INFO -         spark-env:SPARK_DAEMON_MEMORY: 2048m
[2024-03-20T07:04:37.591+0000] {subprocess.py:93} INFO -         spark:spark.driver.maxResultSize: 1024m
[2024-03-20T07:04:37.591+0000] {subprocess.py:93} INFO -         spark:spark.driver.memory: 2048m
[2024-03-20T07:04:37.591+0000] {subprocess.py:93} INFO -         spark:spark.executor.cores: '2'
[2024-03-20T07:04:37.591+0000] {subprocess.py:93} INFO -         spark:spark.executor.instances: '2'
[2024-03-20T07:04:37.591+0000] {subprocess.py:93} INFO -         spark:spark.executor.memory: 6157m
[2024-03-20T07:04:37.592+0000] {subprocess.py:93} INFO -         spark:spark.executorEnv.OPENBLAS_NUM_THREADS: '1'
[2024-03-20T07:04:37.592+0000] {subprocess.py:93} INFO -         spark:spark.scheduler.mode: FAIR
[2024-03-20T07:04:37.592+0000] {subprocess.py:93} INFO -         spark:spark.sql.cbo.enabled: 'true'
[2024-03-20T07:04:37.592+0000] {subprocess.py:93} INFO -         spark:spark.sql.optimizer.runtime.bloomFilter.join.pattern.enabled: 'true'
[2024-03-20T07:04:37.592+0000] {subprocess.py:93} INFO -         spark:spark.ui.port: '0'
[2024-03-20T07:04:37.592+0000] {subprocess.py:93} INFO -         spark:spark.yarn.am.memory: 640m
[2024-03-20T07:04:37.592+0000] {subprocess.py:93} INFO -         yarn-env:YARN_NODEMANAGER_HEAPSIZE: '1638'
[2024-03-20T07:04:37.592+0000] {subprocess.py:93} INFO -         yarn-env:YARN_RESOURCEMANAGER_HEAPSIZE: '2048'
[2024-03-20T07:04:37.593+0000] {subprocess.py:93} INFO -         yarn-env:YARN_TIMELINESERVER_HEAPSIZE: '2048'
[2024-03-20T07:04:37.593+0000] {subprocess.py:93} INFO -         yarn:yarn.nodemanager.address: 0.0.0.0:8026
[2024-03-20T07:04:37.593+0000] {subprocess.py:93} INFO -         yarn:yarn.nodemanager.resource.cpu-vcores: '4'
[2024-03-20T07:04:37.593+0000] {subprocess.py:93} INFO -         yarn:yarn.nodemanager.resource.memory-mb: '13544'
[2024-03-20T07:04:37.593+0000] {subprocess.py:93} INFO -         yarn:yarn.resourcemanager.decommissioning-nodes-watcher.decommission-if-no-shuffle-data: 'true'
[2024-03-20T07:04:37.593+0000] {subprocess.py:93} INFO -         yarn:yarn.resourcemanager.nodemanager-graceful-decommission-timeout-secs: '86400'
[2024-03-20T07:04:37.593+0000] {subprocess.py:93} INFO -         yarn:yarn.scheduler.maximum-allocation-mb: '13544'
[2024-03-20T07:04:37.594+0000] {subprocess.py:93} INFO -         yarn:yarn.scheduler.minimum-allocation-mb: '1'
[2024-03-20T07:04:37.594+0000] {subprocess.py:93} INFO -     tempBucket: dataproc-temp-us-central1-329749248489-tvazyaju
[2024-03-20T07:04:37.594+0000] {subprocess.py:93} INFO -     workerConfig:
[2024-03-20T07:04:37.594+0000] {subprocess.py:93} INFO -       diskConfig:
[2024-03-20T07:04:37.594+0000] {subprocess.py:93} INFO -         bootDiskSizeGb: 300
[2024-03-20T07:04:37.594+0000] {subprocess.py:93} INFO -         bootDiskType: pd-standard
[2024-03-20T07:04:37.594+0000] {subprocess.py:93} INFO -       imageUri: https://www.googleapis.com/compute/v1/projects/cloud-dataproc/global/images/dataproc-2-1-ubu20-20240306-155100-rc01
[2024-03-20T07:04:37.594+0000] {subprocess.py:93} INFO -       machineTypeUri: https://www.googleapis.com/compute/v1/projects/dez-workspace-emil/zones/us-central1-b/machineTypes/e2-standard-4
[2024-03-20T07:04:37.595+0000] {subprocess.py:93} INFO -       minCpuPlatform: AUTOMATIC
[2024-03-20T07:04:37.595+0000] {subprocess.py:93} INFO -       numInstances: 2
[2024-03-20T07:04:37.595+0000] {subprocess.py:93} INFO -       preemptibility: NON_PREEMPTIBLE
[2024-03-20T07:04:37.595+0000] {subprocess.py:93} INFO -   labels:
[2024-03-20T07:04:37.595+0000] {subprocess.py:93} INFO -     goog-dataproc-autozone: enabled
[2024-03-20T07:04:37.595+0000] {subprocess.py:93} INFO -     goog-dataproc-cluster-name: dez-cluster
[2024-03-20T07:04:37.595+0000] {subprocess.py:93} INFO -     goog-dataproc-cluster-uuid: 830261e5-2d3d-4491-a80c-fd201b1ad541
[2024-03-20T07:04:37.595+0000] {subprocess.py:93} INFO -     goog-dataproc-location: us-central1
[2024-03-20T07:04:37.596+0000] {subprocess.py:93} INFO -   projectId: dez-workspace-emil
[2024-03-20T07:04:37.596+0000] {subprocess.py:93} INFO - Waiting for cluster 'dez-cluster' to start....
[2024-03-20T07:04:37.596+0000] {subprocess.py:93} INFO - ...........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................done.
[2024-03-20T07:04:37.649+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2024-03-20T07:04:37.668+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=IDM_TO_BQ_PQ_RAW, task_id=start_cluster, execution_date=20240320T070115, start_date=20240320T070117, end_date=20240320T070437
[2024-03-20T07:04:37.678+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-03-20T07:04:37.692+0000] {taskinstance.py:3312} INFO - 1 downstream tasks scheduled from follow-on schedule check
